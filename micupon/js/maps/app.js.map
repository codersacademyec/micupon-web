{"version":3,"sources":["globalService.js","main.js"],"names":["globalService","$http","$rootScope","sendPush","token","mensaje","post","logout","jwt","window","location","origin","localStorage","removeItem","user","manageSuccess","response","dismissWait","successMessage","showNot","data","manageError","a","b","status","href","msg","doGet","url","showWait","get","then","doPost","text","blockActions","waiting","loadText","isWaiting","loadingText","isBlocked","service","wait","$","angular","module","constant","factory","$q","currentUser","def","defer","Stamplay","User","undefined","resolve","error","reject","promise","config","$httpProvider","defaults","headers"],"mappings":"AAEA,QAAAA,eAAAC,EAAAC,GAeA,QAAAC,GAAAC,EAAAC,GACAJ,EAAAK,KAAA,qEACAF,MAAAA,EACAC,QAAAA,IAIA,QAAAE,KACA,GAAAC,GAAAC,OAAAC,SAAAC,OAAA,MACAF,QAAAG,aAAAC,WAAAL,GACAN,EAAAY,MAAA,EAGA,QAAAC,GAAAC,GAIA,MAHAC,KACA,IAAAC,GAAAC,QAAAD,EAAA,WAEAF,EAAAI,KAGA,QAAAC,GAAAL,EAAAM,EAAAC,GAEA,GADAN,IACA,KAAAD,EAAAQ,OAAA,CACA,GAAA,KAAAR,EAAAQ,OAGA,MAFAd,UAAAe,KAAA,aACAR,IAGA,IAAAS,EAEAA,GADA,KAAAV,EAAAQ,OACAR,EAAAI,KAEA,+BAEAD,QAAAO,EAAA,WAIA,QAAAC,GAAAC,EAAAF,EAAAR,GAIA,MAHAW,GAAAH,EAAAA,EAAA,iBACAR,EAAA,GACAA,IAAAA,EAAAA,GACAjB,EAAA6B,IAAAF,GAAAG,KAAAhB,EAAAM,GAGA,QAAAW,GAAAJ,EAAAR,EAAAM,EAAAR,GAIA,MAHAW,GAAAH,EAAAA,EAAA,iBACAR,EAAA,GACAA,IAAAA,EAAAA,GACAjB,EAAAK,KAAAsB,EAAAR,GAAAW,KAAAhB,EAAAM,GAGA,QAAAQ,GAAAI,GACAC,GAAA,EACAC,GAAA,EACAC,EAAAH,EAGA,QAAAhB,KACAkB,GAAA,EACAD,GAAA,EAGA,QAAAG,KACA,MAAAF,GAGA,QAAAG,KACA,MAAAF,GAGA,QAAAG,KACA,MAAAL,GAtFA,GAAAhB,GAAA,GACAkB,EAAA,GACAF,GAAA,EACAC,GAAA,EACAK,GACAV,IAAAH,EACArB,KAAA0B,EACAS,KAAAJ,EACAC,YAAAA,EACAJ,aAAAK,EACAhC,OAAAA,EACAJ,SAAAA,EA8EA,OAAAqC,GC5FAE,EAAA,cAAAC,QAAAC,OAAA,WAAA,YAAA,iBAAA,gBAAA,gCACAC,SAAA,kBAAA,WAAA,WACAC,QAAA,kBAAA,KAAA,SAAAC,GACA,OACAC,YAAA,WACA,GAAAC,GAAAF,EAAAG,OAWA,OAVAC,UAAAC,KAAAJ,cACAjB,KAAA,SAAAf,GACAqC,SAAArC,EAAAF,KACAmC,EAAAK,SAAA,GAEAL,EAAAK,QAAAtC,EAAAF,OAEA,SAAAyC,GACAN,EAAAO,WAEAP,EAAAQ,aAIAC,QAAA,gBAAA,SAAAC,GACAA,EAAAC,SAAAC,QAAA/B,MACA6B,EAAAC,SAAAC,QAAA/B,QAEA6B,EAAAC,SAAAC,QAAAvD,OACAqD,EAAAC,SAAAC,QAAAvD,SAEAqD,EAAAC,SAAAC,QAAAvD,KAAA,qBAAAqD,EAAAC,SAAAC,QAAA/B,IAAA,qBAAA,gCACA6B,EAAAC,SAAAC,QAAAvD,KAAA,iBAAAqD,EAAAC,SAAAC,QAAA/B,IAAA,iBAAA,WACA6B,EAAAC,SAAAC,QAAAvD,KAAA,OAAAqD,EAAAC,SAAAC,QAAA/B,IAAA,OAAA,cD7BAa,QAAAC,OAAA,WAAAE,QAAA,iBAAA,QAAA,aAAA9C","file":"../app.js","sourcesContent":["angular.module('micupon').factory('globalService', ['$http','$rootScope',globalService]);\n\nfunction globalService($http,$rootScope) {\n    var successMessage = '';\n    var loadText = '';\n    var blockActions = false;\n    var waiting = false;\n    var service = {\n        get: doGet,\n        post: doPost,\n        wait: isWaiting,\n        loadingText: loadingText,\n        blockActions: isBlocked,\n        logout: logout,\n        sendPush: sendPush       \n    };\n\n    function sendPush(token,mensaje){\n        $http.post('https://micupon.stamplayapp.com/api/codeblock/v1/run/pushcercanos',{\n                    \"token\" : token,\n                    \"mensaje\" : mensaje\n                });\n    }\n\n    function logout() {\n        var jwt = window.location.origin + \"-jwt\";\n        window.localStorage.removeItem(jwt);\n        $rootScope.user = false;\n    }\n\n    function manageSuccess(response){\n        dismissWait();\n        if(successMessage != \"\"){showNot(successMessage,'success');}\n        \n        return response.data;\n    }\n\n    function manageError(response,a,b){\n        dismissWait();\n        if(response.status != 200){\n            if(response.status == 999){\n                location.href = '/login';\n                dismissWait();\n                return;\n            }\n            var msg;\n            if(response.status == 406){\n                msg = response.data;\n            }else{\n                msg = \"Ocurrio un error inesperado.\";\n            }\n            showNot(msg,'danger');\n        }\n    }\n\n    function doGet(url,msg,successMessage){\n        showWait(!msg ? 'Procesando...':msg);\n        successMessage = \"\";\n        if(successMessage){successMessage = successMessage;}\n        return $http.get(url).then(manageSuccess,manageError);\n    }\n\n    function doPost(url,data,msg,successMessage){\n        showWait(!msg ? 'Procesando...':msg);\n        successMessage = \"\";\n        if(successMessage){successMessage = successMessage;}\n        return $http.post(url,data).then(manageSuccess,manageError);\n    }\n\n    function showWait(text){\n        blockActions = true;\n        waiting = true;\n        loadText = text;\n    }\n\n    function dismissWait(){\n        waiting = false;\n        blockActions = false;\n    }\n\n    function isWaiting(){\n        return waiting;\n    }\n\n    function loadingText(){\n        return loadText;\n    }\n\n    function isBlocked(){\n        return blockActions;\n    }\n\n    return service;\n}","$(function() {\n    /*lang = {\n        \"sProcessing\": \"Procesando...\",\n        \"sLengthMenu\": \"Mostrar _MENU_ registros\",\n        \"sZeroRecords\": \"No se encontraron resultados\",\n        \"sEmptyTable\": \"Ningún dato disponible en esta tabla\",\n        \"sInfo\": \"_START_ - _END_ (Total: _TOTAL_)\",\n        \"sInfoEmpty\": \"\",\n        \"sInfoFiltered\": \"(filtrado de un total de _MAX_ registros)\",\n        \"sInfoPostFix\": \"\",\n        \"sSearch\": \"Buscar:\",\n        \"sUrl\": \"\",\n        \"sInfoThousands\": \",\",\n        \"sLoadingRecords\": \"Cargando...\",\n        \"oPaginate\": {\n            \"sFirst\": \"Primero\",\n            \"sLast\": \"Último\",\n            \"sNext\": \">>\",\n            \"sPrevious\": \"<<\"\n        },\n        \"oAria\": {\n            \"sSortAscending\": \": Activar para ordenar la columna de manera ascendente\",\n            \"sSortDescending\": \": Activar para ordenar la columna de manera descendente\"\n        }\n    };\n    if ($.fn.dataTable) {\n        $.extend($.fn.dataTable.defaults, {\n            \"lengthChange\": false,\n            language: lang,\n            filter: false\n        });\n    }\n    moment.locale('es');\n    $.material.init();\n    $('[data-toggle=\"tooltip\"]').tooltip();*/\n});"]}