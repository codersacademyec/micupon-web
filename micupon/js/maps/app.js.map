{"version":3,"sources":["globalService.js","main.js"],"names":["globalService","$http","$rootScope","sendPush","token","mensaje","post","logout","jwt","window","location","origin","localStorage","removeItem","user","manageSuccess","response","dismissWait","successMessage","showNot","data","manageError","a","b","status","href","msg","doGet","url","showWait","get","then","doPost","text","blockActions","waiting","loadText","isWaiting","loadingText","isBlocked","service","wait","$","angular","module","constant","factory","$q","currentUser","def","defer","Stamplay","User","undefined","resolve","error","reject","promise","config","$httpProvider","defaults","headers"],"mappings":"AAEA,QAAAA,eAAAC,EAAAC,GAcA,QAAAC,GAAAC,EAAAC,GACAJ,EAAAK,KAAA,qEACAF,MAAAA,EACAC,QAAAA,IAGA,QAAAE,KACA,GAAAC,GAAAC,OAAAC,SAAAC,OAAA,MACAF,QAAAG,aAAAC,WAAAL,GACAN,EAAAY,MAAA,EAEA,QAAAC,GAAAC,GAGA,MAFAC,KACA,IAAAC,GAAAC,QAAAD,EAAA,WACAF,EAAAI,KAEA,QAAAC,GAAAL,EAAAM,EAAAC,GAEA,GADAN,IACA,KAAAD,EAAAQ,OAAA,CACA,GAAA,KAAAR,EAAAQ,OAGA,MAFAd,UAAAe,KAAA,aACAR,IAGA,IAAAS,EAEAA,GADA,KAAAV,EAAAQ,OACAR,EAAAI,KAEA,+BAEAD,QAAAO,EAAA,WAGA,QAAAC,GAAAC,EAAAF,EAAAR,GAIA,MAHAW,GAAAH,EAAAA,EAAA,iBACAR,EAAA,GACAA,IAAAA,EAAAA,GACAjB,EAAA6B,IAAAF,GAAAG,KAAAhB,EAAAM,GAEA,QAAAW,GAAAJ,EAAAR,EAAAM,EAAAR,GAIA,MAHAW,GAAAH,EAAAA,EAAA,iBACAR,EAAA,GACAA,IAAAA,EAAAA,GACAjB,EAAAK,KAAAsB,EAAAR,GAAAW,KAAAhB,EAAAM,GAGA,QAAAQ,GAAAI,GACAC,GAAA,EACAC,GAAA,EACAC,EAAAH,EAGA,QAAAhB,KACAkB,GAAA,EACAD,GAAA,EAEA,QAAAG,KACA,MAAAF,GAEA,QAAAG,KACA,MAAAF,GAEA,QAAAG,KACA,MAAAL,GA5EA,GAAAhB,GAAA,GACAkB,EAAA,GACAF,GAAA,EACAC,GAAA,EACAK,GACAV,IAAAH,EACArB,KAAA0B,EACAS,KAAAJ,EACAC,YAAAA,EACAJ,aAAAK,EACAhC,OAAAA,EACAJ,SAAAA,EAoEA,OAAAqC,GClFAE,EAAA,cAAAC,QAAAC,OAAA,WAAA,YAAA,iBAAA,gBAAA,gCACAC,SAAA,kBAAA,WAAA,WACAC,QAAA,kBAAA,KAAA,SAAAC,GACA,OACAC,YAAA,WACA,GAAAC,GAAAF,EAAAG,OAWA,OAVAC,UAAAC,KAAAJ,cACAjB,KAAA,SAAAf,GACAqC,SAAArC,EAAAF,KACAmC,EAAAK,SAAA,GAEAL,EAAAK,QAAAtC,EAAAF,OAEA,SAAAyC,GACAN,EAAAO,WAEAP,EAAAQ,aAIAC,QAAA,gBAAA,SAAAC,GACAA,EAAAC,SAAAC,QAAA/B,MACA6B,EAAAC,SAAAC,QAAA/B,QAEA6B,EAAAC,SAAAC,QAAAvD,OACAqD,EAAAC,SAAAC,QAAAvD,SAEAqD,EAAAC,SAAAC,QAAAvD,KAAA,qBAAAqD,EAAAC,SAAAC,QAAA/B,IAAA,qBAAA,gCACA6B,EAAAC,SAAAC,QAAAvD,KAAA,iBAAAqD,EAAAC,SAAAC,QAAA/B,IAAA,iBAAA,WACA6B,EAAAC,SAAAC,QAAAvD,KAAA,OAAAqD,EAAAC,SAAAC,QAAA/B,IAAA,OAAA,cD7BAa,QAAAC,OAAA,WAAAE,QAAA,iBAAA,QAAA,aAAA9C","file":"../app.js","sourcesContent":["angular.module('micupon').factory('globalService', ['$http','$rootScope',globalService]);\r\n\r\nfunction globalService($http,$rootScope) {\r\n    var successMessage = '';\r\n    var loadText = '';\r\n    var blockActions = false;\r\n    var waiting = false;\r\n    var service = {\r\n        get: doGet,\r\n        post: doPost,\r\n        wait: isWaiting,\r\n        loadingText: loadingText,\r\n        blockActions: isBlocked,\r\n        logout: logout,\r\n        sendPush: sendPush\r\n    };\r\n    function sendPush(token,mensaje){\r\n        $http.post('https://micupon.stamplayapp.com/api/codeblock/v1/run/pushcercanos',{\r\n                    \"token\" : token,\r\n                    \"mensaje\" : mensaje\r\n                });\r\n    }\r\n    function logout() {\r\n        var jwt = window.location.origin + \"-jwt\";\r\n        window.localStorage.removeItem(jwt);\r\n        $rootScope.user = false;\r\n    }\r\n    function manageSuccess(response){\r\n        dismissWait();\r\n        if(successMessage != \"\"){showNot(successMessage,'success');}\r\n        return response.data;\r\n    }\r\n    function manageError(response,a,b){\r\n        dismissWait();\r\n        if(response.status != 200){\r\n            if(response.status == 999){\r\n                location.href = '/login';\r\n                dismissWait();\r\n                return;\r\n            }\r\n            var msg;\r\n            if(response.status == 406){\r\n                msg = response.data;\r\n            }else{\r\n                msg = \"Ocurrio un error inesperado.\";\r\n            }\r\n            showNot(msg,'danger');\r\n        }\r\n    }\r\n    function doGet(url,msg,successMessage){\r\n        showWait(!msg ? 'Procesando...':msg);\r\n        successMessage = \"\";\r\n        if(successMessage){successMessage = successMessage;}\r\n        return $http.get(url).then(manageSuccess,manageError);\r\n    }\r\n    function doPost(url,data,msg,successMessage){\r\n        showWait(!msg ? 'Procesando...':msg);\r\n        successMessage = \"\";\r\n        if(successMessage){successMessage = successMessage;}\r\n        return $http.post(url,data).then(manageSuccess,manageError);\r\n    }\r\n\r\n    function showWait(text){\r\n        blockActions = true;\r\n        waiting = true;\r\n        loadText = text;\r\n    }\r\n\r\n    function dismissWait(){\r\n        waiting = false;\r\n        blockActions = false;\r\n    }\r\n    function isWaiting(){\r\n        return waiting;\r\n    }\r\n    function loadingText(){\r\n        return loadText;\r\n    }\r\n    function isBlocked(){\r\n        return blockActions;\r\n    }\r\n\r\n    return service;\r\n}","$(function() {\r\n    /*lang = {\r\n        \"sProcessing\": \"Procesando...\",\r\n        \"sLengthMenu\": \"Mostrar _MENU_ registros\",\r\n        \"sZeroRecords\": \"No se encontraron resultados\",\r\n        \"sEmptyTable\": \"Ningún dato disponible en esta tabla\",\r\n        \"sInfo\": \"_START_ - _END_ (Total: _TOTAL_)\",\r\n        \"sInfoEmpty\": \"\",\r\n        \"sInfoFiltered\": \"(filtrado de un total de _MAX_ registros)\",\r\n        \"sInfoPostFix\": \"\",\r\n        \"sSearch\": \"Buscar:\",\r\n        \"sUrl\": \"\",\r\n        \"sInfoThousands\": \",\",\r\n        \"sLoadingRecords\": \"Cargando...\",\r\n        \"oPaginate\": {\r\n            \"sFirst\": \"Primero\",\r\n            \"sLast\": \"Último\",\r\n            \"sNext\": \">>\",\r\n            \"sPrevious\": \"<<\"\r\n        },\r\n        \"oAria\": {\r\n            \"sSortAscending\": \": Activar para ordenar la columna de manera ascendente\",\r\n            \"sSortDescending\": \": Activar para ordenar la columna de manera descendente\"\r\n        }\r\n    };\r\n    if ($.fn.dataTable) {\r\n        $.extend($.fn.dataTable.defaults, {\r\n            \"lengthChange\": false,\r\n            language: lang,\r\n            filter: false\r\n        });\r\n    }\r\n    moment.locale('es');\r\n    $.material.init();\r\n    $('[data-toggle=\"tooltip\"]').tooltip();*/\r\n});"]}