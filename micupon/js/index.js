function indexService(i,n){function o(i){Stamplay.User.socialLogin(n[i])}function e(i,n){return Stamplay.Object("cupones").get(i).then(function(i){if(i.data)for(var o=i.data.length-1;o>=0;o--)n?Stamplay.Object("cupones_usuarios").get({usuario:n._id,codigo:i.data[o].codigo}).then(function(i){i?i.data[o].disable=!0:i.data[o].disable=!1},function(i){}):i.data[o].disable=!1;return i.data})}function a(i){Stamplay.Object("cupones").update("codigo",i).then(function(i){},function(i){})}function t(i){Stamplay.Object("cupones").remove("codigo").then(function(i){},function(i){})}function l(n,o){Stamplay.Object("cupones_usuarios").save({usuario:o._id,codigo:n}).then(function(n){i.sendPush(o.perfil.push_token,"El cup√≥n ha sido enviado a su movil."),addAlert()},function(i){})}var c={busqueda:e,modificar:a,eliminar:t,nuevo:l,login:o};return c}function indexCtrl(i,n,o,e,a,t){var l=this;l.globalService=o,l.cupones=[],l.showFiltros=!1,l.showNuevo=!1,l.filtros={},l.nuevo={},l.itemSeleccionado={},l.modalEliminar=t({scope:i,template:'<div class="modal"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">Eliminar la banda horaria con id {{ctrl.bandaSeleccionada.id}}?</h4></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="$hide()">Cancelar</button><button type="button" class="btn btn-danger" ng-click="ctrl.confirmarElim()">Eliminar</button></div></div></div></div>',html:!0,show:!1,animation:"am-slide-top"}),l.tableConfig={itemsPerPage:5,fillLastPage:!0},l.ingresar=function(i){e.login(i)},l.ocultarSide=function(){l.showFiltros=!1,l.showNuevo=!1},l.buscar=function(){e.busqueda(l.filtros,n.user).then(function(n){l.cupones=n,l.showFiltros=!1,i.$apply()})},l.eliminar=function(i){l.itemSeleccionado=i,l.modalEliminar.$promise.then(l.modalEliminar.show)},l.confirmarElim=function(){e.eliminar(l.itemSeleccionado).then(function(i){l.modalEliminar.$promise.then(l.modalEliminar.hide)})},l.guardar=function(i){n.user?e.nuevo(i,n.user):$("#login-dialog").modal()},l.limpiarFiltros=function(){l.filtros={}},l.buscar(),a.currentUser().then(function(i){(i||n.user)&&(n.user=i?i:n.user,Stamplay.Object("usuarios").get({owner:n.user._id}).then(function(i){n.user.perfil=i.data[0]},function(i){}))})}angular.module("micupon").factory("indexService",["globalService","socialProvider",indexService]),angular.module("micupon").controller("indexCtrl",["$scope","$rootScope","globalService","indexService","AccountService","$modal",indexCtrl]);
//# sourceMappingURL=maps/index.js.map
